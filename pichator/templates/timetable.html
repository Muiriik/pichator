{% extends 'base.html' %}


{% block title %}Úprava pracovní doby{% endblock %}

{% block content %}

{% block scripts %}
<script>
    function submit_timetable() {
        if($('#pvs')[0].length == 1){
            i = 0;
        }
        else{
            i = $('#pvs')[0].selectedIndex;
        }
        console.log($('#pvs')[i].value)
        $('#f_pvs').val($('#pvs')[i].value);
        $('#timetable-form').submit();
    }
    $(document).ready(function () {
        $('.clockpicker').clockpicker()
        $('#pvs').selectpicker();
        timetable = []
        emp_no = '{{ emp_no }}'
        $('#pvs').on('changed.bs.select', function (e) {
            if ($('#pvs')[0].length == 1) {
                i = 0;
            } else {
                i = $('#pvs')[0].selectedIndex;
            }
            $('#occupancy')[0].value = timetable[i].occupancy;
            $('#dept')[0].value = timetable[i].department;
            $('#monF')[0].value = timetable[i].days[0];
            $('#monT')[0].value = timetable[i].days[1];
            $('#tueF')[0].value = timetable[i].days[2];
            $('#tueT')[0].value = timetable[i].days[3];
            $('#wedF')[0].value = timetable[i].days[4];
            $('#wedT')[0].value = timetable[i].days[5];
            $('#thuF')[0].value = timetable[i].days[6];
            $('#thuT')[0].value = timetable[i].days[7];
            $('#friF')[0].value = timetable[i].days[8];
            $('#friT')[0].value = timetable[i].days[9];
        })
        $.ajax({
            url: '/timetable_data',
        }).done(function (data) {
            timetable = data.data
            for (i = 0; i < timetable.length; i++) {
                $('#pvs').append('<option value="' + timetable[i].PV + '" id="' + timetable[i].PV +
                    '">' + timetable[i].PV + '</option>')
            }
            $('#pvs').selectpicker('refresh');
            if ($('#pvs')[0].length == 1) {
                i = 0;
            } else {
                i = $('#pvs')[0].selectedIndex;
            }

            $('#occupancy')[0].value = timetable[i].occupancy;
            $('#dept')[0].value = timetable[i].department;
            $('#monF')[0].value = timetable[i].days[0];
            $('#monT')[0].value = timetable[i].days[1];
            $('#tueF')[0].value = timetable[i].days[2];
            $('#tueT')[0].value = timetable[i].days[3];
            $('#wedF')[0].value = timetable[i].days[4];
            $('#wedT')[0].value = timetable[i].days[5];
            $('#thuF')[0].value = timetable[i].days[6];
            $('#thuT')[0].value = timetable[i].days[7];
            $('#friF')[0].value = timetable[i].days[8];
            $('#friT')[0].value = timetable[i].days[9];
        })
    })
</script>
{% endblock %}

<div class='container-fluid'>
    <div class='row buffer-top-md well'>
        <form id='pv-select' class="form-inline" method='POST'>
            <div class='form-group'>
                <label for='pvs'>Číslo PV:</label>
                <select class='form-control' name='pvs' id='pvs'></select>
            </div>
            <div class='form-group'>
                <label for='occupancy'> Úvazek: </label>
                <input type='text' class='form-control' id='occupancy' name='occupancy' readonly>
            </div>
            <div class='form-group'>
                <label for='dept'> Oddělení: </label>
                <input type='text' class='form-control' id='dept' name='dept' readonly>
            </div>

        </form>
        <div class='form-group'>
            <button class='btn btn-success' onclick="submit_timetable();">Uložit</button>
            <button class='btn btn-warning' onclick='redirect("/timetable");'>Zrušit</button>
        </div>

    </div>
    <div class='row buffer-top-md'>
        <form class='form-inline' id='timetable-form' name='timetable-form' method='post' action='/timetable'>
            <div class='row'>
                <div class='form-group col-xs-1'>
                    <label for='mon-f-picker'>Pondělí od:</label>
                    <div class='input-group clockpicker ' id='mon-f-picker' data-placement='right' data-align='top'
                        data-autoclose='true'>
                        <input type="text" class="form-control" id='monF' name='monF'>
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-time"></span>
                        </span>
                    </div>
                </div>
                <div class='form-group col-xs-1'>
                    <label for='mon-t-picker'>Pondělí do:</label>
                    <div class='input-group clockpicker ' id='mon-t-picker' data-placement='right' data-align='top'
                        data-autoclose='true'>
                        <input type="text" class="form-control" id='monT' name='monT'>
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-time"></span>
                        </span>
                    </div>
                </div>
            </div>
            <div class='row'>
                <div class='form-group col-xs-1'>
                    <label for='tue-f-picker'>Úterý od:</label>
                    <div class='input-group clockpicker ' id='tue-f-picker' data-placement='right' data-align='top'
                        data-autoclose='true'>
                        <input type="text" class="form-control" id='tueF' name='tueF'>
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-time"></span>
                        </span>
                    </div>
                </div>
                <div class='form-group col-xs-1'>
                    <label for='tue-t-picker'>Úterý do:</label>
                    <div class='input-group clockpicker' id='tue-t-picker' data-placement='right' data-align='top'
                        data-autoclose='true'>
                        <input type="text" class="form-control" id='tueT' name='tueT'>
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-time"></span>
                        </span>
                    </div>
                </div>
            </div>
            <div class='row'>
                <div class='form-group col-xs-1'>
                    <label for='wed-f-picker'>Středa od:</label>
                    <div class='input-group clockpicker' id='wef-f-picker' data-placement='right' data-align='top'
                        data-autoclose='true'>
                        <input type="text" class="form-control" id='wedF' name='wedF'>
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-time"></span>
                        </span>
                    </div>
                </div>
                <div class='form-group col-xs-1'>
                    <label for='wed-t-picker'>Středa do:</label>
                    <div class='input-group clockpicker' id='wed-t-picker' data-placement='right' data-align='top'
                        data-autoclose='true'>
                        <input type="text" class="form-control" id='wedT' name='wedT'>
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-time"></span>
                        </span>
                    </div>
                </div>
            </div>
            <div class='row'>
                <div class='form-group col-xs-1'>
                    <label for='thu-f-picker'>Čtvrtek od:</label>
                    <div class='input-group clockpicker' id='thu-f-picker' data-placement='right' data-align='top'
                        data-autoclose='true'>
                        <input type="text" class="form-control" id='thuF' name='thuF'>
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-time"></span>
                        </span>
                    </div>
                </div>
                <div class='form-group col-xs-1'>
                    <label for='thu-t-picker'>Čtvrtek do:</label>
                    <div class='input-group clockpicker' id='thu-t-picker' data-placement='right' data-align='top'
                        data-autoclose='true'>
                        <input type="text" class="form-control" id='thuT' name='thuT'>
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-time"></span>
                        </span>
                    </div>
                </div>
            </div>
            <div class='row'>
                <div class='form-group col-xs-1'>
                    <label for='fri-f-picker'>Pátek od:</label>
                    <div class='input-group clockpicker' id='fri-f-picker' data-placement='right' data-align='top'
                        data-autoclose='true'>
                        <input type="text" class="form-control" id='friF' name='friF'>
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-time"></span>
                        </span>
                    </div>
                </div>
                <div class='form-group col-xs-1'>
                    <label for='fri-t-picker'>Pátek do:</label>
                    <div class='input-group clockpicker' id='fri-t-picker' data-placement='right' data-align='top'
                        data-autoclose='true'>
                        <input type="text" class="form-control" id='friT' name='friT'>
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-time"></span>
                        </span>
                    </div>
                </div>
                <input type='text' hidden='true' id='f_pvs' name='f_pvs'>
            </div>
        </form>
    </div>

</div>

{% endblock %}